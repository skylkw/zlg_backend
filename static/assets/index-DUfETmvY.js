import{_ as B,j as Y,k as Z,l as ee,m as te,F as oe,a as V,u as I,b as h,t as A,o as L,s as y,c as U,d as M,e as k,f as $,g as F,h as H,i as j}from"./useAppStore-Or4QRcAU.js";import{d as q,x as le,y as ae,u as e,o as n,f as b,z as re,n as z,c as i,w as a,e as r,h as c,t as S,A as T,m as se,j as m,s as J,F as E,v as K}from"./index-BPa8dAqI.js";import{c as ne,h as g}from"./Button.vue_vue_type_script_setup_true_lang-eoizMJei.js";import{a as ue}from"./index-mRIFqL3A.js";const me=q({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(d,{emit:t}){const f=d,_=ue(f,"modelValue",t,{passive:!0,defaultValue:f.defaultValue});return(w,x)=>le((n(),b("input",{"onUpdate:modelValue":x[0]||(x[0]=N=>re(_)?_.value=N:null),class:z(e(ne)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",f.class))},null,2)),[[ae,e(_)]])}}),de={key:0,class:"text-primary-text mr-0.5"},O=q({__name:"FormInputField",props:{autocomplete:{},defaultValue:{},description:{},label:{},layout:{default:"horizontal"},name:{},placeholder:{},required:{type:Boolean}},setup(d){const t=d;return(f,p)=>(n(),i(e(oe),{name:t.name},{default:a(({componentField:_})=>[r(e(B),{class:z([t.layout==="horizontal"?"grid grid-cols-4 space-y-0":"flex flex-col","text-nowrap"])},{default:a(()=>[r(e(Y),{class:z([t.layout==="horizontal"?"mr-2 flex-row-reverse":"mb-2","flex items-center justify-start"])},{default:a(()=>[c("h3",null,S(t.label),1),t.required?(n(),b("span",de,"*")):T("",!0)]),_:1},8,["class"]),r(e(Z),{class:"col-span-3"},{default:a(()=>[r(e(me),se(_,{autocomplete:t.autocomplete,"default-value":t.defaultValue||"",placeholder:t.placeholder||"",class:"ring-primary-400 hover:ring-1"}),null,16,["autocomplete","default-value","placeholder"])]),_:2},1024),r(e(ee),{class:"col-start-2"}),r(e(te),{class:"text-primary-600 col-start-2 text-wrap"},{default:a(()=>[m(S(t.description),1)]),_:1})]),_:2},1032,["class"])]),_:1},8,["name"]))}}),Q=d=>{switch(d){case 0:return V.Post("/enable_motor_0");case 1:return V.Post("/enable_motor_1");default:throw new Error("无效的电机索引")}},W=d=>{switch(d){case 0:return V.Post("/disable_motor_0");case 1:return V.Post("/disable_motor_1");default:throw new Error("无效的电机索引")}},X=(d,t)=>{switch(d){case 0:return V.Post("/set_motor_0_speed",t);case 1:return V.Post("/set_motor_1_speed",t);default:throw new Error("无效的电机索引")}},ce={class:"flex flex-col gap-y-4 flex-1"},ie=q({__name:"Motor0Form",setup(d){const t=I(),{send:f}=h(Q,{immediate:!1}),{send:p}=h(W,{immediate:!1}),{send:_}=h(X,{immediate:!1}),w=A(L({motorMode0:y({required_error:"请选择电机模式"}),motorValue0:y({required_error:"请输入速度/扭矩值"}),motorGear0:y({required_error:"请选择挡位"})})),{handleSubmit:x,resetForm:N}=U({validationSchema:w,initialValues:{motorMode0:"2",motorValue0:"0",motorGear0:"2"}}),R=async()=>{await f(0),t.motor0Status=!0,G(0)},C=async()=>{P(),await p(0),t.motor0Status=!1},v=x(async u=>{await _(0,{mode:Number(u.motorMode0),value:Number(u.motorValue0),gear:Number(u.motorGear0)})}),D=[{type:"select",name:"motorMode0",label:"电机工作模式",placeholder:"选择电机工作模式",defaultValue:"2",options:[{value:"0",label:"停止"},{value:"1",label:"扭矩模式"},{value:"2",label:"速度模式"}],required:!0},{type:"input",name:"motorValue0",defaultValue:"0",label:"速度/扭矩值",placeholder:"输入速度/扭矩值",required:!0},{type:"select",name:"motorGear0",label:"挡位",placeholder:"选择挡位",defaultValue:"2",options:[{value:"0",label:"N"},{value:"1",label:"R"},{value:"2",label:"D"}],required:!0}];let s=null;const G=u=>{s&&s.close(),s=new EventSource(`/sse/${u}`),s.onopen=o=>{console.log("SSE connection opened for motor 0",o)},s.onmessage=o=>{t.motor0Data=o.data},s.onerror=o=>{console.error("SSE error for motor 0:",o),s==null||s.close()}},P=u=>{s&&(s.close(),s=null)};return(u,o)=>(n(),i(e(F),{class:"flex flex-col h-full"},{default:a(()=>[r(e(k),null,{default:a(()=>[r(e(M),null,{default:a(()=>o[1]||(o[1]=[m("电机0控制")])),_:1})]),_:1}),r(e($),{class:"flex flex-col flex-1"},{default:a(()=>[e(t).motor0Status?(n(),i(e(g),{key:0,onClick:C,class:"w-full"},{default:a(()=>o[2]||(o[2]=[m("关闭电机")])),_:1})):(n(),i(e(g),{key:1,onClick:R,class:"w-full"},{default:a(()=>o[3]||(o[3]=[m("打开电机")])),_:1})),c("form",{onSubmit:o[0]||(o[0]=K((...l)=>e(v)&&e(v)(...l),["prevent"])),class:"flex flex-col flex-1 mt-4"},[c("div",ce,[(n(),b(E,null,J(D,l=>(n(),b(E,null,[l.type==="select"?(n(),i(H,{key:0,name:l.name,label:l.label,placeholder:l.placeholder,options:l.options||[],defaultValue:l.defaultValue,required:l.required},null,8,["name","label","placeholder","options","defaultValue","required"])):l.type==="input"?(n(),i(O,{key:1,name:l.name,label:l.label,placeholder:l.placeholder,required:l.required},null,8,["name","label","placeholder","required"])):T("",!0)],64))),64))]),r(e(B),{class:"mt-4"},{default:a(()=>[r(e(g),{type:"submit",class:"w-full",disabled:!e(t).motor0Status},{default:a(()=>o[4]||(o[4]=[m("设置速度/扭矩")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1}))}}),pe={class:"flex flex-col gap-y-4 flex-1"},fe=q({__name:"Motor1Form",setup(d){const t=I(),{send:f}=h(Q,{immediate:!1}),{send:p}=h(W,{immediate:!1}),{send:_}=h(X,{immediate:!1}),w=A(L({motorMode1:y({required_error:"请选择电机模式"}),motorValue1:y({required_error:"请输入速度/扭矩值"}),motorGear1:y({required_error:"请选择挡位"})})),{handleSubmit:x,resetForm:N}=U({validationSchema:w,initialValues:{motorMode1:"2",motorValue1:"0",motorGear1:"2"}}),R=async()=>{await f(1),t.motor1Status=!0,G(1)},C=async()=>{P(),await p(1),t.motor1Status=!1},v=x(async u=>{await _(1,{mode:Number(u.motorMode1),value:Number(u.motorValue1),gear:Number(u.motorGear1)})}),D=[{type:"select",name:"motorMode1",label:"电机工作模式",placeholder:"选择电机工作模式",defaultValue:"2",options:[{value:"0",label:"停止"},{value:"1",label:"扭矩模式"},{value:"2",label:"速度模式"}],required:!0},{type:"input",name:"motorValue1",defaultValue:"0",label:"速度/扭矩值",placeholder:"输入速度/扭矩值",required:!0},{type:"select",name:"motorGear1",label:"挡位",placeholder:"选择挡位",defaultValue:"2",options:[{value:"0",label:"N"},{value:"1",label:"R"},{value:"2",label:"D"}],required:!0}];let s=null;const G=u=>{s&&s.close(),s=new EventSource(`/sse/${u}`),s.onopen=o=>{console.log("SSE connection opened for motor 1",o)},s.onmessage=o=>{t.motor1Data=o.data},s.onerror=o=>{console.error("SSE error for motor 1:",o),s==null||s.close()}},P=u=>{s&&(s.close(),s=null)};return(u,o)=>(n(),i(e(F),{class:"flex flex-col h-full"},{default:a(()=>[r(e(k),null,{default:a(()=>[r(e(M),null,{default:a(()=>o[1]||(o[1]=[m("电机1控制")])),_:1})]),_:1}),r(e($),{class:"flex flex-col flex-1"},{default:a(()=>[e(t).motor1Status?(n(),i(e(g),{key:0,onClick:C,class:"w-full"},{default:a(()=>o[2]||(o[2]=[m("关闭电机")])),_:1})):(n(),i(e(g),{key:1,onClick:R,class:"w-full"},{default:a(()=>o[3]||(o[3]=[m("打开电机")])),_:1})),c("form",{onSubmit:o[0]||(o[0]=K((...l)=>e(v)&&e(v)(...l),["prevent"])),class:"flex flex-col flex-1 mt-4"},[c("div",pe,[(n(),b(E,null,J(D,l=>(n(),b(E,null,[l.type==="select"?(n(),i(H,{key:0,name:l.name,label:l.label,placeholder:l.placeholder,options:l.options||[],defaultValue:l.defaultValue,required:l.required},null,8,["name","label","placeholder","options","defaultValue","required"])):l.type==="input"?(n(),i(O,{key:1,name:l.name,label:l.label,placeholder:l.placeholder,required:l.required},null,8,["name","label","placeholder","required"])):T("",!0)],64))),64))]),r(e(B),{class:"mt-4"},{default:a(()=>[r(e(g),{type:"submit",class:"w-full",disabled:!e(t).motor1Status},{default:a(()=>o[4]||(o[4]=[m("设置速度/扭矩")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1}))}}),_e={class:"container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-6 p-4"},be={class:"grid"},xe={class:"flex items-center"},Se={class:"ml-3"},he={class:"grid"},ye={class:"flex items-center"},ge={class:"ml-3"},Me=q({__name:"index",setup(d){const t=I();return(f,p)=>(n(),b("div",_e,[r(ie),r(fe),r(e(F),{class:"col-span-1 lg:col-span-2"},{default:a(()=>[r(e(k),null,{default:a(()=>[r(e(M),null,{default:a(()=>p[0]||(p[0]=[m("电机0状态显示")])),_:1})]),_:1}),r(e($),null,{default:a(()=>[c("div",be,[c("div",xe,[r(e(j),{checked:e(t).motor0Status},null,8,["checked"]),c("span",Se,"电机0状态: "+S(e(t).motor0Status?"开启":"关闭"),1),m(" "+S(e(t).motor0Data),1)])])]),_:1})]),_:1}),r(e(F),{class:"col-span-1 lg:col-span-2"},{default:a(()=>[r(e(k),null,{default:a(()=>[r(e(M),null,{default:a(()=>p[1]||(p[1]=[m("电机1状态显示")])),_:1})]),_:1}),r(e($),null,{default:a(()=>[c("div",he,[c("div",ye,[r(e(j),{checked:e(t).motor1Status},null,8,["checked"]),c("span",ge,"电机1状态: "+S(e(t).motor1Status?"开启":"关闭"),1),m(" "+S(e(t).motor1Data),1)])])]),_:1})]),_:1})]))}});export{Me as default};
